<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>


    <script type="text/javascript" src="../../../jsCommon/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../../../jsCommon/jquery/jquery-ui.min.js"></script>
    <script>
        var paragraphEntitiesProxyUrl = "../../../paragraphEntitiesGraph"
        $(function () {

            var options = {
                "maxParagraphDistance": 2,
                "filterNouns": false,
                "filterAdjs": false,
                "filterVerbs": false,
                "rankPathsByNounfrequency": false,
                "subGraph": "entitiesGraph3"

            };
            var questionObj = {

                "nouns": [
                    "measurment",
                    "turbine",
                    "steam",
                    "inlet"
                ],

                "entities": {
                    "Equipement": [
                        {
                            "name": "Steam Turbine",
                            "id": 311014
                        }
                    ],
                    "Characterisation": [
                        {
                            "name": "Mawp",
                            "id": 311227
                        }
                    ]
                }
            }
            $("#question").val(JSON.stringify(questionObj, null, 2))
            $("#questionOptions").val(JSON.stringify(options, null, 2))


        })


        submitPlainTextQuestionToService = function () {

            var txt = $("#plainTextQuestion").val();
            txt = encodeURIComponent(txt);
            //    var serviceUrl = "http://server-ctg-neo-question.azurewebsites.net/question/";


            var payload = {
                extractEntitiesFromPlainTextQuestion: 1,
                questionText: txt
            };
            $.ajax({
                type: "POST",
                url: paragraphEntitiesProxyUrl,
                data: payload,
                dataType: "json",
                success: function (data, textStatus, jqXHR) {
                    data.format = "TotalQuestionService"
                    $("#question").val(JSON.stringify(data, null, 2));

                }, error: function (err) {
                    alert(JSON.stringify(err, null, 2))

                }
            })


            /*   $.get( serviceUrl+txt, function( data ) {


                       //  $("#response").val(JSON.stringify(data,null,2));
   var x=data;

               })*/


        }


        submitQuestion = function () {


            var str = $("#question").val();

            var optionsStr = $("#questionOptions").val();
            try {
                var payload = {

                    getParagraphsMatchingEntitiesAndWords: 1,
                    question: str,
                    options: optionsStr
                };
                $.ajax({
                    type: "POST",
                    url: paragraphEntitiesProxyUrl,
                    data: payload,
                    dataType: "json",
                    success: function (data, textStatus, jqXHR) {


                        $("#response").val(JSON.stringify(data.response, null, 2));

                    }, error: function (err) {
                        alert(JSON.stringify(err, null, 2))

                    }
                })


            }
            catch (err) {
                alert(err);
            }


        }


    </script>


</head>
<body>

question text<input id="plainTextQuestion" size="50" value="what is the maximum response time anti surge system">
<button onclick="submitPlainTextQuestionToService()">Analyze</button>


<table>


    <tr>
        <td>
            options


            <textarea cols="50" rows="5" id="questionOptions">

            </textarea>

            <br>
            question JSON


        </td>
    </tr>
    <td>
            <textarea cols="50" rows="50" id="question">

            </textarea>

    </td>


    <td>
        <button onclick="submitQuestion()">submit</button>
        <br>
        response
    </td>
    <td>
            <textarea cols="100" rows="50" id="response">





            </textarea>


    </td>


    </tr>


</table>
</body>
</html>